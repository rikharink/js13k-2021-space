!function(){function t(t,s,i=1e-5){let h;return t===s?1:(h=Math.abs(t-s),0===t||0===s||S>h?i*S>h:i>h/(Math.abs(t)+Math.abs(s)))}function s(t,s){if(s)return t[0]=s[0],t[1]=s[1],t}function i(t,s,i){return t[0]=s[0]+i[0],t[1]=s[1]+i[1],t}function h(t,s,i){return t[0]=s[0]-i[0],t[1]=s[1]-i[1],t}function e(t,s,i){return t[0]=s[0]*i,t[1]=s[1]*i,t}function n(t,s){const i=s[0],h=s[1];let e=i*i+h*h;return e>0&&(e=1/Math.sqrt(e)),t[0]=s[0]*e,t[1]=s[1]*e,t}function o(t,s){return Math.hypot(s[0]-t[0],s[1]-t[1])}function r(t,s){const i=s[0]-t[0],h=s[1]-t[1];return i*i+h*h}function c(t,s,i=1){return t[0]=s[1],t[1]=s[0],i?t[1]=-t[1]:t[0]=-t[0],n(t,t)}function u(t){return[(16711680&t)>>16,(65280&t)>>8,255&t]}function a(t=Math.random){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(s=>{let i=16*t()|0;return("x"==s?i:3&i|8).toString(16)}))}function l(t,s){return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${s})`}function d(t,s){const i=r(s.position,t.position);return 0!==i?y.t*(s.i/i):0}function f(t,o){if(!t.h||!t.acceleration)return;const r=[0,0];s(t.o,t.position),e(t.acceleration,n(r,h(r,t.h.position,t.position)),d(t,t.h)),t.u||(t.u=[0,0]),i(t.u,t.u,e(r,t.acceleration,o)),i(t.position,t.position,e(r,t.u,o))}function w(t){const s=t.l;let o=[0,0];const r=t.m(s),u=i([0,0],r,e(o,n(o,h(o,r,t.position)),y.p)),a=c([0,0],h(o,r,u));e(a,a,y.v);const l=i([0,0],u,a),d=new L(r,l);return new I(d.g,[y.p/2,y.v/2],s)}function m(t,s){const i=t.position[0]-s.position[0],h=t.position[1]-s.position[1],e=t.M+s.M;return e*e>i*i+h*h}function p(t,s){const n=h([0,0],t.position,s.position),o=[1,0,0,1,0,0];return((t,s)=>{let i=Math.sin(s),h=Math.cos(s);t[0]=h,t[1]=i,t[2]=-i,t[3]=h,t[4]=0,t[5]=0})(o,-s.orientation),((t,s,i)=>{let h=s[0],e=s[1];t[0]=i[0]*h+i[2]*e+i[4],t[1]=i[1]*h+i[3]*e+i[5]})(n,n,o),((t,s)=>{const[i,h]=t.position,[e,n]=s.position,[o,r]=s.size;let c=i,u=h;e>i?c=e:i>e+o&&(c=e+o),n>h?u=n:h>n+r&&(u=n+r);let a=new L([i,h],[c,u]);return t.M*t.M>=a.S})(new P(i([0,0],n,s.P),t.M),new T([0,0],e([0,0],s.P,2)))}function x(t,s){let i=t.clone();return e(i._.position,i._.position,s),e(i._.acceleration,i._.acceleration,s),e(i._.u,i._.u,s),i}function v(t,s,i,h=1){t.fillStyle=l(i,h),t.beginPath(),t.arc(s.position[0],s.position[1],s.M,0,6.283185307179586),t.closePath(),t.fill()}function g(t,s,i){t.lineWidth=1,t.lineCap="round",t.strokeStyle=l(i,1),t.beginPath(),t.moveTo(s.start[0],s.start[1]),t.lineTo(s.end[0],s.end[1]),t.closePath(),t.stroke()}function M(t,s,o){g(t,s,o);let r=[0,0];s.B(-y.v);let a=i([0,0],s.g,e(r,c([0,0],n(r,h(r,s.start,s.end))),y.v));t.fillStyle=l(u(15913899),1),t.beginPath(),t.moveTo(s.start[0],s.start[1]),t.lineTo(a[0],a[1]),t.lineTo(s.end[0],s.end[1]),t.closePath(),t.fill()}class b extends class{constructor(){this.I=[],this.L=[]}T(t){return this.I.push(t),{A:()=>this.C(t)}}once(t){this.L.push(t)}C(t){var s=this.I.indexOf(t);s>-1&&this.I.splice(s,1)}F(t){if(this.I.forEach((s=>s(t))),this.L.length>0){const s=this.L;this.L=[],s.forEach((s=>s(t)))}}$(t){return this.T((s=>t.F(s)))}}{constructor(t){super(),this.k=0,this.R=t,window.addEventListener("pointerdown",this.q.bind(this)),window.addEventListener("pointermove",this.q.bind(this)),window.addEventListener("pointerup",this.q.bind(this)),window.addEventListener("blur",this.D.bind(this))}D(){this.k=0}q(t){this.position=this.G(this.R,[t.clientX,t.clientY]),this.k=!!t.buttons,this.F(this.k)}G(t,s){let i=t.getBoundingClientRect();return[t.width/i.width*(s[0]-i.left),t.height/i.height*(s[1]-i.top)]}O(){return this.k}}const y={V:[1334,750],W:164,j:"g",seed:"IPTS",H:1e6,t:1,J:2e3,K:0,N:1300,U:1,p:45,v:18,X:50},S=Math.pow(2,-1022);class P{constructor(t,s){this.position=t,this.M=s}m(t){return[this.position[0]+this.M*Math.cos(t),this.position[1]+this.M*Math.sin(t)]}}class _ extends P{constructor(t,i,h=0,e,n,o=.8){super(t,i),this.o=[0,0],s(this.o,this.position),this.i=h,this.u=e,this.acceleration=n,this.Y=o}Z(t){const s=t[0]-this.position[0],i=t[1]-this.position[1];return this.M*this.M>s*s+i*i}clone(){return new _(s([0,0],this.position),this.M,this.i,s([0,0],this.u),s([0,0],this.acceleration),this.Y)}}class z extends _{constructor(t,s){super([10,10],5,y.K,[0,0],[0,0]),this.color=u(13016997),this.tt=0,this.st=0,this.it=0,this.ht=2,this.et=2*y.W,this.nt=2*y.W,this.ot=0,this.rt=[],this.ct=0,this.id=s??a(),this.ut=t}at(){this.lt()}step(){this.dt&&this.ct++,this.ct>30&&(this.ct=0,this.st=0),this.ot?(this.nt>0||(this.ot=0,y.U=1),this.nt--):this.et>this.nt&&(this.nt+=.1)}get ft(){return~~(this.nt/this.et*100)}get dt(){return!(!t((s=this.position)[0],(i=this.o)[0],h)||!t(s[1],i[1],h));var s,i,h}get wt(){return this.ht>this.st}xt(){this.rt.push(s([0,0],this.position)),this.rt.length>y.X&&this.rt.shift()}lt(){if(!this.wt)return void(y.U=1);const t=this.ut.O();var s,i,r;!this.tt&&t?(this.vt=[0,0],this.gt=this.ut.position,1>this.st||(y.U=.1,this.ot=1)):this.tt&&!t?(e(this.u,this.vt,y.N*this.Mt),this.gt=void 0,this.vt=void 0,this.Mt=void 0,this.st++,this.it++,y.U=1,this.ot=0):this.ut.position&&this.gt&&(i=this.vt,r=n(this.vt,h(this.vt,this.ut.position,this.gt)),i[0]=-r[0],i[1]=-r[1],this.Mt=(s=o(this.gt,this.ut.position),Math.max(0,Math.min(100,s))/100)),this.tt=t}clone(){let t=new z(this.ut);return t.id=this.id,t.h=this.h?.clone(),t.position=s([0,0],this.position),t.o=s([0,0],this.o),t.u=s([0,0],this.u),t.acceleration=s([0,0],this.acceleration),t.tt=this.tt,t.vt=s([0,0],this.vt),t.Mt=this.Mt,t.it=this.it,t.st=this.st,t.gt=s([0,0],this.gt),t.ht=this.ht,t.nt=this.nt,t.rt=this.rt.map((t=>s([0,0],t))),t}}class B extends _{constructor(t,s,i,h,e,n,o,r){super(t,s,i*y.H,e,n,o),this.color=u(9137564),this.id=h??a(),this.l=r}get bt(){return y.t*this.i}yt(t){return Math.sqrt(this.bt/t)}clone(){let t=new B(s([0,0],this.position),this.M,this.i,this.id,this.u,this.acceleration,this.Y,this.l);return t.h=this.h,t}}class I{constructor(t,s,i){this.position=t??[0,0],this.P=s??[1,1],this.orientation=i??0}}class L{constructor(t,s){this.start=t,this.end=s}B(t){let s=this.end[0]-this.start[0],i=this.end[1]-this.start[1],h=Math.sqrt(s*s+i*i);return h>0&&(s/=h,i/=h),s*=h+t,i*=h+t,this.start[0]=this.start[0]+s,this.start[1]=this.start[1]+i,this}get g(){return[(this.start[0]+this.end[0])/2,(this.start[1]+this.end[1])/2]}get length(){return o(this.start,this.end)}get S(){return r(this.start,this.end)}}class T{constructor(t,s){this.position=t,this.size=s}static St(t,s){return new T(t,h([0,0],s,t))}get min(){const t=this.position,s=i([0,0],this.position,this.size);return[Math.min(t[0],s[0]),Math.min(t[1],s[1])]}get max(){const t=this.position,s=i([0,0],this.position,this.size);return[Math.max(t[0],s[0]),Math.max(t[1],s[1])]}}class A{constructor({size:t,_:s,Pt:i}){this.size=t,this._=s,this.Pt=i}static _t(t,i){let h=new z(t);return s(h.position,i.zt),new A({size:i.size,_:h,Pt:i.Bt.map((t=>new B(s([0,0],t.position),t.M,t.i,t.id,s([0,0],t.u),s([0,0],t.acceleration),t.Y,t.l)))})}step(t){this._.step(),((t,s)=>{(t=>{let s,i,h,e=[t._,...t.Pt];for(i of e){let e=-1/0;for(h of t.Pt){if(i===h)continue;let t=d(i,h);e>t||(e=t,s=h)}i.h=s}})(s);let i=[s._,...s.Pt];for(let s of i)f(s,t*y.U)})(t,this);const i=((t,i)=>{let n=0,r=0,c=[0,0],u=[i._,...i.Pt];for(let t of u)for(let i of u)if(t!==i&&m(t,i)){n=1,s(t.position,t.o);const r=[(t.position[0]*i.M+i.position[1]*t.M)/(t.M+i.M),(t.position[1]*i.M+i.position[1]*t.M)/(t.M+i.M)];let u=[0,0];e(u,h(c,i.position,r),1/o(r,i.position));let a=2*(t.u[0]*u[0]+t.u[1]*u[1])/(t.i+i.i);t.u=e(t.u,[t.u[0]-a*t.i*u[0]-a*i.i*u[0],t.u[1]-a*t.i*u[1]-a*i.i*u[1]],i.Y)}let a=i.Pt.filter((t=>void 0!==t.l));for(let t of a)p(i._,w(t))&&(n=r=1,i._.u=[0,0]);return{It:n,Lt:r}})(0,this);return this._.xt(),i}clone(){return new A({size:s([0,0],this.size),_:this._.clone(),Pt:this.Pt.map((t=>t.clone()))})}}class C{constructor(t,s){this.Tt=0,this.R=t,this.At=document.createElement("canvas").getContext("2d"),this.Ct(),this.Ft=this.R.getContext("2d"),this.$t=s,this.kt=((t,s,i,h)=>{const e=document.createElement("canvas");e.id="bg",e.width=t,e.height=s;const n=e.getContext("2d"),o=[];for(;h>0;h--)o.push([i()*t,i()*s,1.2*i()]);n.fillStyle=l(u(2565956),1),n.fillRect(0,0,t,s);for(let t of o??[])n.beginPath(),n.arc(t[0],t[1],t[2],0,360),n.fillStyle=l(u(16512495),.8),n.fill();return e})(y.V[0],y.V[1],this.$t,y.J)}set Rt(t){this.Tt=t}Ct(){this.R.width=y.V[0],this.R.height=y.V[1],this.At.canvas.width=y.V[0],this.At.canvas.height=y.V[1]}qt(t,s){let o=[0,0];for(let r of s.Pt??[])if(v(t,r,r.color),void 0!==r.l){const s=r.m(r.l),c=i([0,0],s,e(o,n(o,h(o,s,r.position)),y.p));M(t,new L(s,c),u(13016997))}}Dt(t,s){for(let i=s._.rt.length-1;i>0;i--){const h=i/(s._.rt.length-1);v(t,new P(s._.rt[i],s._.M),s._.color,h)}if(s._.wt&&s._.vt&&s._.Mt){let h=[0,0];const n=i(h,s._.position,e(h,s._.vt,75*s._.Mt));((t,s,i)=>{g(t,s,i)})(t,new L(s._.position,n),u(13016997))}}Gt(t,s){s._.h&&g(t,new L(s._.position,s._.h.position),u(15913899)),t.fillStyle=l(u(16512495),1),t.fillRect(8,8,100,48),t.fillStyle=l(u(2565956),1),t.fillText("FPS: "+this.Tt,12,20),t.fillText("TLC: "+s._.it,12,46),t.fillText(`SPP: ${s._.ft}%`,12,33)}Et(t){const s=this.At;s.drawImage(this.kt,0,0),this.qt(s,t),this.Dt(s,t),this.Gt(s,t),this.Ft.drawImage(this.At.canvas,0,0)}}class F{constructor(){this.Ot=0,document.monetization&&("started"!==document.monetization.state&&"stopped"!==document.monetization.state?document.monetization.addEventListener("monetizationstart",this.Vt.bind(this)):this.Ot="started"===document.monetization.state)}Vt(){this.Ot=1}}var $={size:[1920,1080],zt:[155,246],Bt:[{position:[200,320],M:75,i:75},{position:[600,520],M:75,i:75},{position:[950,120],M:100,i:100,l:0}]};const k=new class{constructor(){this.Rt=60,this.isActive=0,this.Wt=0,this.jt=0,this.Ht=0,this.Jt=0,this.Kt=document.getElementById(y.j),this.Nt=new b(this.Kt),this.Nt.once((()=>this.Qt=new AudioContext).bind(this)),this.Ut=new F,this.$t=(t=>{for(var s=0,i=2166136261;t.length>s;s++)i=Math.imul(i^t.charCodeAt(s),16777619);i+=i<<13,i^=i>>>7,i+=i<<3,i^=i>>>17;let h=(i+=i<<5)>>>0,e=()=>(2**31-1&(h=Math.imul(48271,h)))/2**31;return e(),e})(y.seed),this.Xt=new C(this.Kt,this.$t),window.addEventListener("focus",this.start.bind(this)),window.addEventListener("blur",this.stop.bind(this)),this.Yt($)}Yt(t){this.currentState=A._t(this.Nt,t),this.Zt=this.currentState}start(){void 0===this.ts&&(this.ts=requestAnimationFrame(this.ss.bind(this)),this.isActive=1)}stop(){this.ts&&cancelAnimationFrame(this.ts),this.ts=void 0,this.isActive=0}hs(t){let s=.001*t;return this.Wt=s-this.Ht,this.Ht=s,this.jt+=this.Wt,this.Rt=.9*this.Rt+1/this.Wt*(1-.9),this.Xt.Rt=~~this.Rt,1>this.jt||(this.jt=0),s}ss(t){if(this.ts=requestAnimationFrame(this.ss.bind(this)),t=this.hs(t),1>=this.Wt){for(this.currentState._.at(),this.Jt+=this.Wt,this.Jt+=this.Wt;this.Jt>=1/y.W;)this.Zt=this.currentState.clone(),this.currentState.step(1/y.W).Lt&&(this.currentState._.position=s([0,0],$.zt)),this.Jt-=1/y.W,t+=this.Wt;this.Xt.Et((h=this.Zt,((t,s)=>{let h=s.clone();return i(h._.position,t._.position,s._.position),i(h._.acceleration,t._.acceleration,s._.acceleration),i(h._.u,t._.u,s._.u),h})(x(this.currentState,e=this.Jt/this.Wt),x(h,1-e))))}var h,e}};class R{constructor(t,s){this.es=[];let i=t.captureStream();i&&(this.stream=i,this.ns=s||25e5,this.os=document.createElement("video"),this.os.style.display="none")}rs(){let t=["video/webm","video/webm,codecs=vp9","video/vp8","video/webm;codecs=vp8","video/webm;codecs=daala","video/webm;codecs=h264","video/mpeg"];for(let s in t)if(MediaRecorder.isTypeSupported(t[s])){this.cs=t[s];break}let s={mimeType:this.cs,videoBitsPerSecond:this.ns};this.es=[];try{this.us=new MediaRecorder(this.stream,s)}catch(t){return}this.us.onstop=this.ls.bind(this),this.us.ondataavailable=this.ds.bind(this),this.us.start(100)}ds(t){t.data&&t.data.size>0&&this.es.push(t.data)}ls(t){const s=new Blob(this.es,{type:this.cs});this.os.src=window.URL.createObjectURL(s)}fs(){this.us.stop(),this.os.controls=1}download(t){const s=t||"recording.webm",i=new Blob(this.es,{type:this.cs}),h=window.URL.createObjectURL(i),e=document.createElement("a");e.style.display="none",e.href=h,e.download=s,document.body.appendChild(e),e.click(),setTimeout((()=>{document.body.removeChild(e),window.URL.revokeObjectURL(h)}),100)}}k.start();{const t=window;t.ws=()=>new R(document.getElementById("g")),document.addEventListener("keypress",(s=>{"r"===s.key?k.Yt($):"p"===s.key?k.isActive?k.stop():k.start():"o"===s.key?t.ps?t.ps&&(t.ps=0,t.xs.fs(),t.xs.download("IPTS-demo.webm"),delete t.xs):(t.ps=1,t.xs=t.ws(),t.xs.rs()):"s"===s.key?y.U=1>y.U?1:.05:"b"===s.key&&k.currentState.Pt.forEach((t=>{t.i=-10*t.i,t.acceleration=[0,0]}))}))}}();
//# sourceMappingURL=bundle.js.map
